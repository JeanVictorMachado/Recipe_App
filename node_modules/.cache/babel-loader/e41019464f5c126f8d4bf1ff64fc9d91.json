{"ast":null,"code":"var _jsxFileName = \"/home/jean/Trybe/projetos-Trybe/sd-06-project-recipes-app/src/Pages/ProcessoComida.jsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { detailsFoodById } from '../services/aPI';\nimport Instructions from '../components/Instructions';\nimport ContextAPI from '../Context/ContextAPI';\nimport BasicInfo from '../components/BasicInfo';\nimport IngredientsCheckbox from '../components/IngredientsCheckbox';\nimport './ProcessoComida.css';\n\nconst ReceitaProcessoComida = () => {\n  const [foodDetails, setFoodDetails] = useState();\n  const [isRecipeDone, setIsRecipeDone] = useState(false);\n  const idFood = useParams().id;\n  const {\n    detailsInfo,\n    setDetailsInfo,\n    isRecipeFinished\n  } = useContext(ContextAPI);\n\n  const getFoodDetails = async () => {\n    const food = await detailsFoodById(idFood);\n    setFoodDetails({ ...foodDetails,\n      food: food.meals[0]\n    });\n    setDetailsInfo({ ...detailsInfo,\n      foods: food.meals[0]\n    });\n  };\n\n  const loadDoneRecipesFromStorage = () => {\n    if (localStorage.getItem('doneRecipes') === null) {\n      const doneRecipes = [];\n      localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    }\n\n    const doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n    const isCurrentRecipeDone = doneRecipes.some(key => key.id === idFood);\n    if (isCurrentRecipeDone) setIsRecipeDone(true);else setIsRecipeDone(false);\n  };\n\n  useEffect(() => {\n    getFoodDetails();\n    loadDoneRecipesFromStorage();\n  }, []);\n\n  const removeFoodFromProgress = () => {\n    const progressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n\n    if (progressRecipes !== null) {\n      const progressKeys = Object.keys(progressRecipes.meals);\n      let mealsObject = {};\n      progressKeys.forEach(key => {\n        if (key !== idFood) {\n          mealsObject = { ...mealsObject,\n            [key]: progressKeys[key]\n          };\n        }\n      });\n      localStorage.setItem('inProgressRecipes', JSON.stringify({ ...progressRecipes,\n        meals: mealsObject\n      }));\n    }\n  };\n\n  const setDoneRecipes = () => {\n    if (foodDetails) {\n      removeFoodFromProgress();\n      setIsRecipeDone(true);\n      const doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n      localStorage.setItem('doneRecipes', JSON.stringify([...doneRecipes, {\n        id: foodDetails.food.idMeal,\n        type: 'comida',\n        area: foodDetails.food.strArea,\n        category: foodDetails.food.strCategory,\n        alcoholicOrNot: '',\n        name: foodDetails.food.strMeal,\n        photoFood: foodDetails.food.strMealThumb,\n        doneDate: '',\n        tags: foodDetails.food.strTags ? foodDetails.food.strTags : []\n      }]));\n    } else return '';\n  };\n\n  const showDoneRecipeBtn = () => /*#__PURE__*/React.createElement(Link, {\n    to: \"/receitas-feitas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"finish-recipe-btn\",\n    onClick: setDoneRecipes,\n    disabled: !isRecipeFinished,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, \"Finalizar Receita\"));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, !foodDetails ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, \"Loading...\") : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"body-progress\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BasicInfo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(IngredientsCheckbox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Instructions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  }, !isRecipeDone && showDoneRecipeBtn())));\n};\n\nexport default ReceitaProcessoComida;","map":{"version":3,"sources":["/home/jean/Trybe/projetos-Trybe/sd-06-project-recipes-app/src/Pages/ProcessoComida.jsx"],"names":["React","useState","useEffect","useContext","Link","useParams","detailsFoodById","Instructions","ContextAPI","BasicInfo","IngredientsCheckbox","ReceitaProcessoComida","foodDetails","setFoodDetails","isRecipeDone","setIsRecipeDone","idFood","id","detailsInfo","setDetailsInfo","isRecipeFinished","getFoodDetails","food","meals","foods","loadDoneRecipesFromStorage","localStorage","getItem","doneRecipes","setItem","JSON","stringify","parse","isCurrentRecipeDone","some","key","removeFoodFromProgress","progressRecipes","progressKeys","Object","keys","mealsObject","forEach","setDoneRecipes","idMeal","type","area","strArea","category","strCategory","alcoholicOrNot","name","strMeal","photoFood","strMealThumb","doneDate","tags","strTags","showDoneRecipeBtn"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,IAAT,EAAeC,SAAf,QAAgC,kBAAhC;AAEA,SAASC,eAAT,QAAgC,iBAAhC;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,OAAOC,mBAAP,MAAgC,mCAAhC;AACA,OAAO,sBAAP;;AAEA,MAAMC,qBAAqB,GAAG,MAAM;AAClC,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCZ,QAAQ,EAA9C;AACA,QAAM,CAACa,YAAD,EAAeC,eAAf,IAAkCd,QAAQ,CAAC,KAAD,CAAhD;AAEA,QAAMe,MAAM,GAAGX,SAAS,GAAGY,EAA3B;AAEA,QAAM;AAAEC,IAAAA,WAAF;AAAeC,IAAAA,cAAf;AAA+BC,IAAAA;AAA/B,MAAoDjB,UAAU,CAACK,UAAD,CAApE;;AAEA,QAAMa,cAAc,GAAG,YAAY;AACjC,UAAMC,IAAI,GAAG,MAAMhB,eAAe,CAACU,MAAD,CAAlC;AAEAH,IAAAA,cAAc,CAAC,EACb,GAAGD,WADU;AAEbU,MAAAA,IAAI,EAAEA,IAAI,CAACC,KAAL,CAAW,CAAX;AAFO,KAAD,CAAd;AAIAJ,IAAAA,cAAc,CAAC,EAAE,GAAGD,WAAL;AAAkBM,MAAAA,KAAK,EAAEF,IAAI,CAACC,KAAL,CAAW,CAAX;AAAzB,KAAD,CAAd;AACD,GARD;;AAUA,QAAME,0BAA0B,GAAG,MAAM;AACvC,QAAIC,YAAY,CAACC,OAAb,CAAqB,aAArB,MAAwC,IAA5C,EAAkD;AAChD,YAAMC,WAAW,GAAG,EAApB;AACAF,MAAAA,YAAY,CAACG,OAAb,CAAqB,aAArB,EAAoCC,IAAI,CAACC,SAAL,CAAeH,WAAf,CAApC;AACD;;AAED,UAAMA,WAAW,GAAGE,IAAI,CAACE,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAApB;AACA,UAAMM,mBAAmB,GAAGL,WAAW,CAACM,IAAZ,CAAkBC,GAAD,IAASA,GAAG,CAAClB,EAAJ,KAAWD,MAArC,CAA5B;AAEA,QAAIiB,mBAAJ,EAAyBlB,eAAe,CAAC,IAAD,CAAf,CAAzB,KACKA,eAAe,CAAC,KAAD,CAAf;AACN,GAXD;;AAaAb,EAAAA,SAAS,CAAC,MAAM;AACdmB,IAAAA,cAAc;AACdI,IAAAA,0BAA0B;AAC3B,GAHQ,EAGN,EAHM,CAAT;;AAKA,QAAMW,sBAAsB,GAAG,MAAM;AACnC,UAAMC,eAAe,GAAGP,IAAI,CAACE,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,mBAArB,CAAX,CAAxB;;AACA,QAAIU,eAAe,KAAK,IAAxB,EAA8B;AAC5B,YAAMC,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYH,eAAe,CAACd,KAA5B,CAArB;AACA,UAAIkB,WAAW,GAAG,EAAlB;AACAH,MAAAA,YAAY,CAACI,OAAb,CAAsBP,GAAD,IAAS;AAC5B,YAAIA,GAAG,KAAKnB,MAAZ,EAAoB;AAClByB,UAAAA,WAAW,GAAG,EAAE,GAAGA,WAAL;AAAkB,aAACN,GAAD,GAAOG,YAAY,CAACH,GAAD;AAArC,WAAd;AACD;AACF,OAJD;AAKAT,MAAAA,YAAY,CAACG,OAAb,CAAqB,mBAArB,EAA0CC,IAAI,CAACC,SAAL,CAAe,EACvD,GAAGM,eADoD;AAEvDd,QAAAA,KAAK,EAAEkB;AAFgD,OAAf,CAA1C;AAID;AACF,GAfD;;AAiBA,QAAME,cAAc,GAAG,MAAM;AAC3B,QAAI/B,WAAJ,EAAiB;AACfwB,MAAAA,sBAAsB;AACtBrB,MAAAA,eAAe,CAAC,IAAD,CAAf;AAEA,YAAMa,WAAW,GAAGE,IAAI,CAACE,KAAL,CAAWN,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAApB;AACAD,MAAAA,YAAY,CAACG,OAAb,CAAqB,aAArB,EAAoCC,IAAI,CAACC,SAAL,CAAe,CAAC,GAAGH,WAAJ,EAAiB;AAClEX,QAAAA,EAAE,EAAEL,WAAW,CAACU,IAAZ,CAAiBsB,MAD6C;AAElEC,QAAAA,IAAI,EAAE,QAF4D;AAGlEC,QAAAA,IAAI,EAAElC,WAAW,CAACU,IAAZ,CAAiByB,OAH2C;AAIlEC,QAAAA,QAAQ,EAAEpC,WAAW,CAACU,IAAZ,CAAiB2B,WAJuC;AAKlEC,QAAAA,cAAc,EAAE,EALkD;AAMlEC,QAAAA,IAAI,EAAEvC,WAAW,CAACU,IAAZ,CAAiB8B,OAN2C;AAOlEC,QAAAA,SAAS,EAAEzC,WAAW,CAACU,IAAZ,CAAiBgC,YAPsC;AAQlEC,QAAAA,QAAQ,EAAE,EARwD;AASlEC,QAAAA,IAAI,EAAE5C,WAAW,CAACU,IAAZ,CAAiBmC,OAAjB,GACF7C,WAAW,CAACU,IAAZ,CAAiBmC,OADf,GAEF;AAX8D,OAAjB,CAAf,CAApC;AAaD,KAlBD,MAkBO,OAAO,EAAP;AACR,GApBD;;AAsBA,QAAMC,iBAAiB,GAAG,mBACxB,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAC,kBAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,IAAI,EAAC,QADP;AAEE,mBAAY,mBAFd;AAGE,IAAA,OAAO,EAAGf,cAHZ;AAIE,IAAA,QAAQ,EAAG,CAAEvB,gBAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADF,CADF;;AAaA,sBAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAACR,WAAD,gBACG;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADH,gBAGG;AAAK,IAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,mBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,eAGE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,eAIE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAACE,YAAD,IAAiB4C,iBAAiB,EADrC,CAJF,CAJN,CAFF;AAiBD,CAzGD;;AA2GA,eAAe/C,qBAAf","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { Link, useParams } from 'react-router-dom';\n\nimport { detailsFoodById } from '../services/aPI';\nimport Instructions from '../components/Instructions';\nimport ContextAPI from '../Context/ContextAPI';\nimport BasicInfo from '../components/BasicInfo';\nimport IngredientsCheckbox from '../components/IngredientsCheckbox';\nimport './ProcessoComida.css';\n\nconst ReceitaProcessoComida = () => {\n  const [foodDetails, setFoodDetails] = useState();\n  const [isRecipeDone, setIsRecipeDone] = useState(false);\n\n  const idFood = useParams().id;\n\n  const { detailsInfo, setDetailsInfo, isRecipeFinished } = useContext(ContextAPI);\n\n  const getFoodDetails = async () => {\n    const food = await detailsFoodById(idFood);\n\n    setFoodDetails({\n      ...foodDetails,\n      food: food.meals[0],\n    });\n    setDetailsInfo({ ...detailsInfo, foods: food.meals[0] });\n  };\n\n  const loadDoneRecipesFromStorage = () => {\n    if (localStorage.getItem('doneRecipes') === null) {\n      const doneRecipes = [];\n      localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    }\n\n    const doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n    const isCurrentRecipeDone = doneRecipes.some((key) => key.id === idFood);\n\n    if (isCurrentRecipeDone) setIsRecipeDone(true);\n    else setIsRecipeDone(false);\n  };\n\n  useEffect(() => {\n    getFoodDetails();\n    loadDoneRecipesFromStorage();\n  }, []);\n\n  const removeFoodFromProgress = () => {\n    const progressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if (progressRecipes !== null) {\n      const progressKeys = Object.keys(progressRecipes.meals);\n      let mealsObject = {};\n      progressKeys.forEach((key) => {\n        if (key !== idFood) {\n          mealsObject = { ...mealsObject, [key]: progressKeys[key] };\n        }\n      });\n      localStorage.setItem('inProgressRecipes', JSON.stringify({\n        ...progressRecipes,\n        meals: mealsObject,\n      }));\n    }\n  };\n\n  const setDoneRecipes = () => {\n    if (foodDetails) {\n      removeFoodFromProgress();\n      setIsRecipeDone(true);\n\n      const doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n      localStorage.setItem('doneRecipes', JSON.stringify([...doneRecipes, {\n        id: foodDetails.food.idMeal,\n        type: 'comida',\n        area: foodDetails.food.strArea,\n        category: foodDetails.food.strCategory,\n        alcoholicOrNot: '',\n        name: foodDetails.food.strMeal,\n        photoFood: foodDetails.food.strMealThumb,\n        doneDate: '',\n        tags: foodDetails.food.strTags\n          ? foodDetails.food.strTags\n          : [],\n      }]));\n    } else return '';\n  };\n\n  const showDoneRecipeBtn = () => (\n    <Link to=\"/receitas-feitas\">\n      <button\n        type=\"button\"\n        data-testid=\"finish-recipe-btn\"\n        onClick={ setDoneRecipes }\n        disabled={ !(isRecipeFinished) }\n      >\n        Finalizar Receita\n      </button>\n    </Link>\n  );\n\n  return (\n\n    <div>\n      {!foodDetails\n        ? <div className=\"loading\">Loading...</div>\n        : (\n          <div className=\"body-progress\">\n            <BasicInfo />\n            <IngredientsCheckbox />\n            <Instructions />\n            <div className=\"container-button\">\n              {!isRecipeDone && showDoneRecipeBtn()}\n            </div>\n          </div>\n        )}\n    </div>\n  );\n};\n\nexport default ReceitaProcessoComida;\n"]},"metadata":{},"sourceType":"module"}